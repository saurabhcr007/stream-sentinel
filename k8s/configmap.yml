# Stream Sentinel â€“ ConfigMap for Detection Rules
apiVersion: v1
kind: ConfigMap
metadata:
  name: stream-sentinel-rules
  namespace: stream-sentinel
  labels:
    app.kubernetes.io/name: stream-sentinel
    app.kubernetes.io/component: config
data:
  rules.yml: |
    rules:
      - name: high_rate
        type: rate
        keyField: userId
        windowSeconds: 10
        threshold: 5

      - name: high_amount
        type: threshold
        field: amount
        threshold: 10000

      - name: unusual_amount
        type: statistical
        field: amount
        windowSize: 20
        deviationFactor: 2.5
        threshold: 0
